<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Porta Precios – Finde MODO</title>
  <link rel="stylesheet" href="./estilos.css">
</head>
<body>

<div class="controles no-print">
  <button onclick="limpiarTodo()">Limpiar todo</button>
  <button onclick="window.print()">Imprimir</button>
</div>

<div class="hoja">

  <!-- CARTEL BASE -->
  <div class="cartel">

    <!-- ENCABEZADO -->
    <div class="header">
      <span>PAGANDO CON</span>
      <img src="./logo-modo.png" class="logo-modo" alt="MODO">
    </div>

    <!-- INPUTS -->
    <input class="input-nombre no-print" placeholder="Producto">
    <input class="input-precio no-print" placeholder="Precio sin descuento">

    <!-- NOMBRE IMPRIMIBLE -->
    <div class="nombre-producto">Nombre del producto</div>

    <!-- PRECIO ANTES -->
    <div class="antes">Antes: $<span>0,00</span></div>

    <!-- PRECIO AHORA + DIARCO -->
    <div class="precio-con-logo">
      <div class="ahora">
        <span class="precio-grande">$0</span><span class="centavos">,00</span>
      </div>
      <img src="logo-diarco.png" class="logo-diarco" alt="Diarco">
    </div>

  </div>

  <!-- CLONAMOS 4 -->
  <div class="cartel"></div>
  <div class="cartel"></div>
  <div class="cartel"></div>

</div>

<script>
  const MAX_PRECIO = 9999999; // 9.999.999 (ajustá si querés)
  const DESCUENTO = 0.8;      // 20% off (precio * 0.8)

  // duplicar estructura
  document.querySelectorAll('.cartel').forEach((c, i) => {
    if (i > 0) c.innerHTML = document.querySelector('.cartel').innerHTML;
  });

  // Limpia caracteres raros: deja solo números, punto y coma
  function limpiarInputPrecio(str) {
    return (str || '').replace(/[^\d.,]/g, '');
  }

  // Convierte "1.234,56" -> 1234.56
  function normalizar(valor) {
    if (!valor) return NaN;
    const limpio = valor.replace(/\./g, '').replace(',', '.');
    return Number(limpio);
  }

  // Formatea a es-AR con 2 decimales y separadores
  function formato(n) {
    const [p, c] = n.toLocaleString('es-AR', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }).split(',');
    return { p, c };
  }

  // Nombre
  document.querySelectorAll('.input-nombre').forEach(input => {
    input.addEventListener('input', () => {
      const cartel = input.closest('.cartel');
      cartel.querySelector('.nombre-producto').textContent =
        input.value.trim() || 'Nombre del producto';
    });
  });

  // Precio (con anti-billones)
  document.querySelectorAll('.input-precio').forEach(input => {

    // Mientras escriben, limpiamos letras/símbolos
    input.addEventListener('input', () => {
      input.value = limpiarInputPrecio(input.value);

      const cartel = input.closest('.cartel');
      const precio = normalizar(input.value);

      if (isNaN(precio)) return;

      if (precio <= 0) return;

      // Anti "billones": evita que rompan el diseño y que sea irreal
      if (precio > MAX_PRECIO) {
        alert("Precio demasiado grande. Revisá que lo escribiste bien (ej: 1.299,99).");
        return;
      }

      const antes = formato(precio);
      const ahora = formato(precio * DESCUENTO);

      cartel.querySelector('.antes span').textContent = `${antes.p},${antes.c}`;
      cartel.querySelector('.precio-grande').textContent = `$${ahora.p}`;
      cartel.querySelector('.centavos').textContent = `,${ahora.c}`;
    });
  });

  function limpiarTodo() {
    document.querySelectorAll('input').forEach(i => i.value = '');
    document.querySelectorAll('.nombre-producto').forEach(n => n.textContent = 'Nombre del producto');
    document.querySelectorAll('.antes span').forEach(s => s.textContent = '0,00');
    document.querySelectorAll('.precio-grande').forEach(p => p.textContent = '$0');
    document.querySelectorAll('.centavos').forEach(c => c.textContent = ',00');
  }
</script>

</body>
</html>